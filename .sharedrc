# ~/.bashrc: executed by bash(1) for non-login shells.
# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)
# for examples

# If not running interactively, don't do anything
case $- in
    *i*) ;;
      *) return;;
esac

# don't put duplicate lines or lines starting with space in the history.
# See bash(1) for more options
HISTCONTROL=ignoreboth

# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)
HISTSIZE=1000
HISTFILESIZE=2000

# make less more friendly for non-text input files, see lesspipe(1)
[ -x /usr/bin/lesspipe ] && eval "$(SHELL=/bin/sh lesspipe)"

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion


umask 002
ulimit -n 1024

# set PATH so it includes user's private bin if it exists
if [ -d ~/bin ] ; then
    PATH=~/bin:"${PATH}"
fi

# set PATH so it includes user's private bin if it exists
if [ -d "$HOME/.local/bin" ] ; then
    PATH="$HOME/.local/bin:$PATH"
fi

# do the same with MANPATH
if [ -d ~/man ]; then
    MANPATH=~/man:"${MANPATH}"
fi

if [ -f ~/.shared_aliases ]; then
    . ~/.shared_aliases
fi

# Terminal setup
export GREP_COLOR='00;38;5;226'
export LESS="-FRX"

if [ -n "$TERM_OVERRIDE" ]; then
    export TERM="$TERM_OVERRIDE"
fi


export EDITOR=vim
export VISUAL=$EDITOR

# Turn on ZSH autocomplete https://unix.stackexchange.com/a/477909
[[ "$SHELL" == *zsh* ]] && autoload -Uz compinit && compinit

# FZF lsetup
# Using highlight (http://www.andre-simon.de/doku/highlight/en/highlight.html)
export FZF_PREVIEW_OPTS='(highlight -O ansi -l {} 2> /dev/null || cat {} || tree -C {}) 2> /dev/null | head -200'
export FZF_DEFAULT_OPTS="--height 40% --layout=reverse --info=inline --exact --bind 'ctrl-d:page-down' --bind 'ctrl-u:page-up' --preview '$FZF_PREVIEW_OPTS' --preview-window right:hidden --bind '?:toggle-preview'"
export FZF_TMUX=1
export FZF_TMUX_OPTS=''
export FZF_CTRL_T_OPTS="--preview-window nohidden"
alias fzft=fzf-tmux
alias fzfp='fzf-tmux --preview-window nohidden'
export FZF_CTRL_R_OPTS="--preview 'echo {}' --preview-window down:3:hidden:wrap --bind '?:toggle-preview'"

#if [ -n "${commands[fzf-share]}" ]; then
#  source "$(fzf-share)/key-bindings.zsh"
#  source "$(fzf-share)/completion.zsh"
#fi


export AD_USERNAME=dkjer

# This works around the error .../k8s-webhook-server/serving-certs/tls.crt: no such file or directory)
export ENABLE_WEBHOOKS=false

# Configure go
export GOPROXY=https://artifactory.rbx.com/api/go/go-all
export GOPRIVATE=*github.rbx.com
export GONOPROXY=none
export GONOSUMDB=github.rbx.com

# Configure locale
#LC_ALL=en_US.UTF-8
#LANG=en_US.UTF-8
LC_ALL=C
LANG=C

export KUBECONFIG=~/.kube/rksconfig

# 🚦 🚥 👻 🎃 🎄 🎅 🐒 🙈 🙉 🙊 ✨ ⭐ 🌟 💫 🚀 🌜 🌛 🌙 🌝 🌞 🚧 🚨 🚩 ⏳ ☕ ⚡ ⛄ ⛅ 🌈
# 🌵 🍀 🍄 🍎 🍏 🍒 🍓 🍗 🍣 🍥 🍭 🍯 🍺 🎁 🎈 🎉 🎊 🎣 🎩 🎮 🎯 🎲 🏠 🏢 🏭 🏰 🐉 🐊 🐓
# 🎠 🐌 🐍 🐙 🐞 🐡 🐢 🐧 🐬 🐱 🐈 🐇 🐁 🐳 🐋 🐲 🐸 🐶 🐵 🐺 🐼 🐾 👣 👜 👹 👺 👽 👾 👿
# 👑 💎 💡 💣 💥 💩 📌 📦 🔋 🔑 🔒 🔓 🔐 🔔 🔗 🔍 🔎 🔥 🔦 🔧 🔨 🔩 🔫 🔮 🔱 🗿 💀 🌎 🌍
# 🚂 🚰 🌐

OS=$(uname)

case "$OS" in
    "Darwin")
        OS_ICON=" "
        ;;
    "Linux")
        OS_ICON=""
        if [ -f "/etc/os-release" ]; then
            if grep -q "ID=ubuntu" /etc/os-release; then
                OS_ICON=""
            elif grep -q "ID=debian" /etc/os-release; then
                OS_ICON=""
            fi
        fi
        ;;
    *)
        OS_ICON="👾"
        ;;
esac
export OS_ICON

# Add this to ~/.localrc to override
#export OS_ICON="💫"
if [ -f ~/.localrc ]; then
  source ~/.localrc
fi

